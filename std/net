# shellcheck shell=bash
@src std/job

net.is_ping_available(){
    ping -c 2 "${1:?ip}" 1>/dev/null 2>&1
}

net.mping(){
    for ip in "$@"; do
        job.put "${MAX:-100}" "net.is_ping_available $ip && echo $ip"
    done

    while read -r -d ' ' ip; do
        job.put "${MAX:-100}" "net.is_ping_available $ip && echo $ip"
    done

    echo "Waiting until all jobs finished" >&2
    job.wait_until_finished
}

net.public_ip(){
    # Provide more choices
    curl https://ipecho.net/plain 2>/dev/null
}
