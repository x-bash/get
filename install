which x

if [ $? -ne 0 ]; then
    curl https://x-cmder.github.io/install | bash
fi

# TODO: remove the line
# CMD_STR="D=\"\$HOME/.x-cmd.com/x-bash/boot\" eval '[ -f \$D ] || (mkdir -p \$(dirname \$D) && curl \"https://x-bash.github.io/boot\" >\$D) && source \$D'"
# if grep -F "$CMD_STR"

X_STR='eval "$(x @bash/boot)"'

if grep -F "$X_STR" "$HOME/.bashrc" >/dev/null; then
    echo Already install >&2
else
    echo "$X_STR" >> $HOME/.bashrc
    echo Installed in "$HOME/.bashrc" >&2
fi

if grep -F "$X_STR" "$HOME/.bash_profile" >/dev/null; then
    echo Already install >&2
else
    echo "$X_STR" >> $HOME/.bash_profile
    echo Installed in "$HOME/.bash_profile" >&2
fi

eval "$X_STR"

if [ ! -z "$ALL" ]; then
    # TODO: download release/tar/gz. So we donot need to download the files one by one
    for i in "$(curl https://x-bash.github.io/index)"; do;
        @src $i
    done
fi
